import time
import more_itertools as mit
from pwn import *
from py_console import console


def filer_string_to_int(string) -> int:
    # fuck regx
    numeric_filter = filter(str.isdigit, string)
    numeric_string = "".join(numeric_filter)
    return int(numeric_string)


def main():
    '''
    iterable = range(0, 1000)
    numbers = [list(c) for c in mit.divide(10, iterable)]

    print("To solve in hand (impossible due to 60s time limit):")
    for list in numbers:
        for num in list:
            print(str(num) + " ", end="")
        print()'''
    context(arch = 'i386', os = 'linux')

    r = remote('pwnable.kr', 9007)
    # EXPLOIT CODE GOES HERE
    print(r.recv().decode())
    time.sleep(3)


    while True:
        NC = r.recv().decode()
        print(NC)
        
        N_chances = filer_string_to_int(NC.split(' ')[0])
        C_int = filer_string_to_int(NC.split(' ')[1])
        
        for i in range(C_int):
            end_num = i * 100 + 100
            if end_num % 100 != 0 and i + 1 == N_chances // 100 + 1:
                end_num = N_chances - i * 100
            iterable = range(i * 100, end_num)
            numbers = [list(c) for c in mit.divide(1, iterable)]
            for row in numbers:
                payload = ""
                for num in row:
                    payload += str(num)
                    if row[-1] != num:
                        payload += " "
                console.success(bytes(payload.encode()))
                r.sendline(bytes(payload.encode()))
                
                sum_string = r.recv().decode()
                print(sum_string)
                
if __name__ == '__main__':
    main()